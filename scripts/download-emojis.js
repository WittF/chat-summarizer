const fs = require('fs')
const path = require('path')
const https = require('https')

// å¸¸ç”¨emojiæ˜ å°„è¡¨
const emojiMap = {
  'ğŸ¤–': '1f916',
  'ğŸ˜€': '1f600',
  'ğŸ˜ƒ': '1f603',
  'ğŸ˜„': '1f604',
  'ğŸ˜': '1f601',
  'ğŸ˜†': '1f606',
  'ğŸ˜…': '1f605',
  'ğŸ˜‚': '1f602',
  'ğŸ¤£': '1f923',
  'ğŸ˜Š': '1f60a',
  'ğŸ™‚': '1f642',
  'ğŸ˜‰': '1f609',
  'ğŸ˜': '1f60d',
  'ğŸ¥°': '1f970',
  'ğŸ˜˜': '1f618',
  'ğŸ˜‹': '1f60b',
  'ğŸ˜›': '1f61b',
  'ğŸ˜': '1f61d',
  'ğŸ˜œ': '1f61c',
  'ğŸ¤ª': '1f929',
  'ğŸ¤¨': '1f928',
  'ğŸ§': '1f9d0',
  'ğŸ¤“': '1f913',
  'ğŸ˜': '1f60e',
  'ğŸ¤©': '1f929',
  'ğŸ¥³': '1f973',
  'ğŸ˜': '1f60f',
  'ğŸ˜’': '1f612',
  'ğŸ˜': '1f61e',
  'ğŸ˜”': '1f614',
  'ğŸ˜Ÿ': '1f61f',
  'ğŸ˜•': '1f615',
  'ğŸ™': '1f641',
  'ğŸ˜£': '1f623',
  'ğŸ˜–': '1f616',
  'ğŸ˜«': '1f62b',
  'ğŸ˜©': '1f629',
  'ğŸ¥º': '1f97a',
  'ğŸ˜¢': '1f622',
  'ğŸ˜­': '1f62d',
  'ğŸ˜¤': '1f624',
  'ğŸ˜ ': '1f620',
  'ğŸ˜¡': '1f621',
  'ğŸ¤¬': '1f92c',
  'ğŸ¤¯': '1f92f',
  'ğŸ˜±': '1f631',
  'ğŸ˜¨': '1f628',
  'ğŸ˜°': '1f630',
  'ğŸ˜¥': '1f625',
  'ğŸ˜“': '1f613',
  'ğŸ¤—': '1f917',
  'ğŸ¤”': '1f914',
  'ğŸ¤­': '1f92d',
  'ğŸ¤«': '1f92b',
  'ğŸ¤¥': '1f925',
  'ğŸ˜¶': '1f636',
  'ğŸ˜': '1f610',
  'ğŸ˜‘': '1f611',
  'ğŸ˜¬': '1f62c',
  'ğŸ™„': '1f644',
  'ğŸ˜¯': '1f62f',
  'ğŸ˜¦': '1f626',
  'ğŸ˜§': '1f627',
  'ğŸ˜®': '1f62e',
  'ğŸ˜²': '1f632',
  'ğŸ¥±': '1f971',
  'ğŸ˜´': '1f634',
  'ğŸ¤¤': '1f924',
  'ğŸ˜ª': '1f62a',
  'ğŸ˜µ': '1f635',
  'ğŸ¤': '1f910',
  'ğŸ¥´': '1f974',
  'ğŸ¤¢': '1f922',
  'ğŸ¤®': '1f92e',
  'ğŸ¤§': '1f927',
  'ğŸ˜·': '1f637',
  'ğŸ¤’': '1f912',
  'ğŸ¤•': '1f915',
  'ğŸ¤‘': '1f911',
  'ğŸ¤ ': '1f920',
  'ğŸ˜ˆ': '1f608',
  'ğŸ‘¿': '1f47f',
  'ğŸ‘¹': '1f479',
  'ğŸ‘º': '1f47a',
  'ğŸ¤¡': '1f921',
  'ğŸ’©': '1f4a9',
  'ğŸ‘»': '1f47b',
  'ğŸ’€': '1f480',
  'â˜ ï¸': '2620-fe0f',
  'ğŸ‘½': '1f47d',
  'ğŸ‘¾': '1f47e',
  'ğŸ‰': '1f389',
  'ğŸŠ': '1f38a',
  'ğŸˆ': '1f388',
  'ğŸ': '1f381',
  'ğŸ€': '1f380',
  'ğŸ‚': '1f382',
  'ğŸ°': '1f370',
  'ğŸ§': '1f9c1',
  'ğŸ­': '1f36d',
  'ğŸ¬': '1f36c',
  'ğŸ«': '1f36b',
  'ğŸ©': '1f369',
  'ğŸª': '1f36a',
  'ğŸ¥›': '1f95b',
  'â˜•': '2615',
  'ğŸµ': '1f375',
  'ğŸº': '1f37a',
  'ğŸ»': '1f37b',
  'ğŸ¥‚': '1f942',
  'ğŸ·': '1f377',
  'ğŸ¾': '1f37e',
  'ğŸ¸': '1f378',
  'ğŸ¹': '1f379',
  'ğŸ¼': '1f37c',
  'ğŸ¥ƒ': '1f943',
  'ğŸ”¥': '1f525',
  'ğŸ’§': '1f4a7',
  'ğŸŒŠ': '1f30a',
  'â„ï¸': '2744-fe0f',
  'â­': '2b50',
  'ğŸŒŸ': '1f31f',
  'âœ¨': '2728',
  'ğŸŒˆ': '1f308',
  'â˜€ï¸': '2600-fe0f',
  'ğŸŒ¤ï¸': '1f324-fe0f',
  'â›…': '26c5',
  'ğŸŒ¥ï¸': '1f325-fe0f',
  'â˜ï¸': '2601-fe0f',
  'ğŸŒ¦ï¸': '1f326-fe0f',
  'ğŸŒ§ï¸': '1f327-fe0f',
  'â›ˆï¸': '26c8-fe0f',
  'ğŸŒ©ï¸': '1f329-fe0f',
  'ğŸŒ¨ï¸': '1f328-fe0f',
  'â¤ï¸': '2764-fe0f',
  'ğŸ§¡': '1f9e1',
  'ğŸ’›': '1f49b',
  'ğŸ’š': '1f49a',
  'ğŸ’™': '1f499',
  'ğŸ’œ': '1f49c',
  'ğŸ¤': '1f90d',
  'ğŸ–¤': '1f5a4',
  'ğŸ¤': '1f90e',
  'ğŸ’”': '1f494',
  'â£ï¸': '2763-fe0f',
  'ğŸ’•': '1f495',
  'ğŸ’': '1f49e',
  'ğŸ’“': '1f493',
  'ğŸ’—': '1f497',
  'ğŸ’–': '1f496',
  'ğŸ’˜': '1f498',
  'ğŸ’': '1f49d',
  'ğŸ’Ÿ': '1f49f',
  'ğŸ¯': '1f3af',
  'ğŸ®': '1f3ae',
  'ğŸ•¹ï¸': '1f579-fe0f',
  'ğŸ°': '1f3b0',
  'ğŸ²': '1f3b2',
  'ğŸ§©': '1f9e9',
  'ğŸ§¸': '1f9f8',
  'ğŸ­': '1f3ad',
  'ğŸ¨': '1f3a8',
  'ğŸ‘“': '1f453',
  'ğŸ•¶ï¸': '1f576-fe0f',
  'ğŸ‘”': '1f454',
  'ğŸ‘•': '1f455',
  'ğŸ‘–': '1f456',
  'ğŸ‘—': '1f457',
  'ğŸ‘˜': '1f458',
  'ğŸ‘™': '1f459',
  'ğŸ‘š': '1f45a',
  'ğŸ‘›': '1f45b',
  'ğŸ‘œ': '1f45c',
  'ğŸ‘': '1f45d',
  'ğŸ’': '1f392',
  'ğŸ‘': '1f45e',
  'ğŸ‘Ÿ': '1f45f',
  'ğŸ‘ ': '1f460',
  'ğŸ‘¡': '1f461',
  'ğŸ‘¢': '1f462',
  'ğŸ‘‘': '1f451',
  'ğŸ‘’': '1f452',
  'ğŸ©': '1f3a9',
  'ğŸ“': '1f393',
  'ğŸ’„': '1f484',
  'ğŸ’': '1f48d',
  'ğŸ’': '1f48e',
  'ğŸ”‡': '1f507',
  'ğŸ”ˆ': '1f508',
  'ğŸ”‰': '1f509',
  'ğŸ”Š': '1f50a',
  'ğŸ“¢': '1f4e2',
  'ğŸ“£': '1f4e3',
  'ğŸ“¯': '1f4ef',
  'ğŸ””': '1f514',
  'ğŸ”•': '1f515',
  'ğŸ¼': '1f3bc',
  'ğŸµ': '1f3b5',
  'ğŸ¶': '1f3b6',
  'ğŸ¤': '1f3a4',
  'ğŸ§': '1f3a7',
  'ğŸ“»': '1f4fb',
  'ğŸ·': '1f3b7',
  'ğŸ¸': '1f3b8',
  'ğŸ¹': '1f3b9',
  'ğŸº': '1f3ba',
  'ğŸ»': '1f3bb',
  'ğŸ¥': '1f941',
  'ğŸ“±': '1f4f1',
  'ğŸ“²': '1f4f2',
  'â˜ï¸': '260e-fe0f',
  'ğŸ“': '1f4de',
  'ğŸ“Ÿ': '1f4df',
  'ğŸ“ ': '1f4e0',
  'ğŸ”‹': '1f50b',
  'ğŸ”Œ': '1f50c',
  'ğŸ’»': '1f4bb',
  'ğŸ–¥ï¸': '1f5a5-fe0f',
  'ğŸ–¨ï¸': '1f5a8-fe0f',
  'âŒ¨ï¸': '2328-fe0f',
  'ğŸ–±ï¸': '1f5b1-fe0f',
  'ğŸ’½': '1f4bd',
  'ğŸ’¾': '1f4be',
  'ğŸ’¿': '1f4bf',
  'ğŸ“€': '1f4c0',
  'ğŸ¥': '1f3a5',
  'ğŸ“½ï¸': '1f4fd-fe0f',
  'ğŸ¬': '1f3ac',
  'ğŸ“º': '1f4fa',
  'ğŸ“·': '1f4f7',
  'ğŸ“¸': '1f4f8',
  'ğŸ“¹': '1f4f9',
  'ğŸ“¼': '1f4fc',
  'ğŸ”': '1f50d',
  'ğŸ”': '1f50e',
  'ğŸ•¯ï¸': '1f56f-fe0f',
  'ğŸ’¡': '1f4a1',
  'ğŸ”¦': '1f526',
  'ğŸ®': '1f3ee',
  'ğŸ“”': '1f4d4',
  'ğŸ“•': '1f4d5',
  'ğŸ“–': '1f4d6',
  'ğŸ“—': '1f4d7',
  'ğŸ“˜': '1f4d8',
  'ğŸ“™': '1f4d9',
  'ğŸ“š': '1f4da',
  'ğŸ““': '1f4d3',
  'ğŸ“’': '1f4d2',
  'ğŸ“ƒ': '1f4c3',
  'ğŸ“œ': '1f4dc',
  'ğŸ“„': '1f4c4',
  'ğŸ“°': '1f4f0',
  'ğŸ“‘': '1f4d1',
  'ğŸ”–': '1f516',
  'ğŸ’°': '1f4b0',
  'ğŸ’´': '1f4b4',
  'ğŸ’µ': '1f4b5',
  'ğŸ’¶': '1f4b6',
  'ğŸ’·': '1f4b7',
  'ğŸ’¸': '1f4b8',
  'ğŸ’³': '1f4b3',
  'ğŸ’¹': '1f4b9',
  'âœ‰ï¸': '2709-fe0f',
  'ğŸ“§': '1f4e7',
  'ğŸ“¨': '1f4e8',
  'ğŸ“©': '1f4e9',
  'ğŸ“¤': '1f4e4',
  'ğŸ“¥': '1f4e5',
  'ğŸ“¦': '1f4e6',
  'ğŸ“«': '1f4eb',
  'ğŸ“ª': '1f4ea',
  'ğŸ“¬': '1f4ec',
  'ğŸ“­': '1f4ed',
  'ğŸ“®': '1f4ee',
  'âœï¸': '270f-fe0f',
  'âœ’ï¸': '2712-fe0f',
  'ğŸ–‹ï¸': '1f58b-fe0f',
  'ğŸ–Šï¸': '1f58a-fe0f',
  'ğŸ–Œï¸': '1f58c-fe0f',
  'ğŸ–ï¸': '1f58d-fe0f',
  'ğŸ“': '1f4dd',
  'ğŸ’¼': '1f4bc',
  'ğŸ“': '1f4c1',
  'ğŸ“‚': '1f4c2',
  'ğŸ“…': '1f4c5',
  'ğŸ“†': '1f4c6',
  'ğŸ“‡': '1f4c7',
  'ğŸ“ˆ': '1f4c8',
  'ğŸ“‰': '1f4c9',
  'ğŸ“Š': '1f4ca',
  'ğŸ“‹': '1f4cb',
  'ğŸ“Œ': '1f4cc',
  'ğŸ“': '1f4cd',
  'ğŸ“': '1f4ce',
  'ğŸ“': '1f4cf',
  'ğŸ“': '1f4d0',
  'âœ‚ï¸': '2702-fe0f',
  'ğŸ”’': '1f512',
  'ğŸ”“': '1f513',
  'ğŸ”': '1f50f',
  'ğŸ”': '1f510',
  'ğŸ”‘': '1f511',
  'ğŸ”¨': '1f528',
  'â›ï¸': '26cf-fe0f',
  'âš’ï¸': '2692-fe0f',
  'ğŸ› ï¸': '1f6e0-fe0f',
  'âš”ï¸': '2694-fe0f',
  'ğŸ¹': '1f3f9',
  'ğŸ›¡ï¸': '1f6e1-fe0f',
  'ğŸ”§': '1f527',
  'ğŸ”©': '1f529',
  'âš™ï¸': '2699-fe0f',
  'âš–ï¸': '2696-fe0f',
  'ğŸ”—': '1f517',
  'â›“ï¸': '26d3-fe0f',
  'âš—ï¸': '2697-fe0f',
  'ğŸ§ª': '1f9ea',
  'ğŸ§«': '1f9eb',
  'ğŸ§¬': '1f9ec',
  'ğŸ”¬': '1f52c',
  'ğŸ”­': '1f52d',
  'ğŸ“¡': '1f4e1',
  'ğŸ’‰': '1f489',
  'ğŸ’Š': '1f48a',
  'ğŸšª': '1f6aa',
  'ğŸš½': '1f6bd',
  'ğŸš¿': '1f6bf',
  'ğŸ›': '1f6c1',
  'ğŸ›’': '1f6d2',
  'ğŸš¬': '1f6ac',
  'âš°ï¸': '26b0-fe0f',
  'âš±ï¸': '26b1-fe0f',
  'ğŸ—¿': '1f5ff',
  'ğŸ§': '1f3e7',
  'ğŸš®': '1f6ae',
  'ğŸš°': '1f6b0',
  'â™¿': '267f',
  'ğŸš¹': '1f6b9',
  'ğŸšº': '1f6ba',
  'ğŸš»': '1f6bb',
  'ğŸš¼': '1f6bc',
  'ğŸš¾': '1f6be',
  'ğŸ›‚': '1f6c2',
  'ğŸ›ƒ': '1f6c3',
  'ğŸ›„': '1f6c4',
  'ğŸ›…': '1f6c5',
  'âš ï¸': '26a0-fe0f',
  'ğŸš¸': '1f6b8',
  'â›”': '26d4',
  'ğŸš«': '1f6ab',
  'ğŸš³': '1f6b3',
  'ğŸš­': '1f6ad',
  'ğŸš¯': '1f6af',
  'ğŸš±': '1f6b1',
  'ğŸš·': '1f6b7',
  'ğŸ“µ': '1f4f5',
  'ğŸ”': '1f51e',
  'â˜¢ï¸': '2622-fe0f',
  'â˜£ï¸': '2623-fe0f',
  'â¬†ï¸': '2b06-fe0f',
  'â†—ï¸': '2197-fe0f',
  'â¡ï¸': '27a1-fe0f',
  'â†˜ï¸': '2198-fe0f',
  'â¬‡ï¸': '2b07-fe0f',
  'â†™ï¸': '2199-fe0f',
  'â¬…ï¸': '2b05-fe0f',
  'â†–ï¸': '2196-fe0f',
  'â†•ï¸': '2195-fe0f',
  'â†”ï¸': '2194-fe0f',
  'â†©ï¸': '21a9-fe0f',
  'â†ªï¸': '21aa-fe0f',
  'â¤´ï¸': '2934-fe0f',
  'â¤µï¸': '2935-fe0f',
  'ğŸ”ƒ': '1f503',
  'ğŸ”„': '1f504',
  'ğŸ”™': '1f519',
  'ğŸ”š': '1f51a',
  'ğŸ”›': '1f51b',
  'ğŸ”œ': '1f51c',
  'ğŸ”': '1f51d',
  'ğŸ”€': '1f500',
  'ğŸ”': '1f501',
  'ğŸ”‚': '1f502',
  'â–¶ï¸': '25b6-fe0f',
  'â©': '23e9',
  'â­ï¸': '23ed-fe0f',
  'â¯ï¸': '23ef-fe0f',
  'â—€ï¸': '25c0-fe0f',
  'âª': '23ea',
  'â®ï¸': '23ee-fe0f',
  'ğŸ”¼': '1f53c',
  'â«': '23eb',
  'ğŸ”½': '1f53d',
  'â¬': '23ec',
  'â¸ï¸': '23f8-fe0f',
  'â¹ï¸': '23f9-fe0f',
  'âºï¸': '23fa-fe0f',
  'âï¸': '23cf-fe0f',
  'ğŸ¦': '1f3a6',
  'ğŸ”…': '1f505',
  'ğŸ”†': '1f506',
  'ğŸ“¶': '1f4f6',
  'ğŸ“³': '1f4f3',
  'ğŸ“´': '1f4f4',
  'âœ–ï¸': '2716-fe0f',
  'â•': '2795',
  'â–': '2796',
  'â—': '2797',
  'â™¾ï¸': '267e-fe0f',
  'â€¼ï¸': '203c-fe0f',
  'â‰ï¸': '2049-fe0f',
  'â“': '2753',
  'â”': '2754',
  'â•': '2755',
  'â—': '2757',
  'ã€°ï¸': '3030-fe0f',
  'ğŸ’±': '1f4b1',
  'ğŸ’²': '1f4b2',
  'âš•ï¸': '2695-fe0f',
  'â™»ï¸': '267b-fe0f',
  'âšœï¸': '269c-fe0f',
  'ğŸ”±': '1f531',
  'ğŸ“›': '1f4db',
  'ğŸ”°': '1f530',
  'â­•': '2b55',
  'âœ…': '2705',
  'â˜‘ï¸': '2611-fe0f',
  'âœ”ï¸': '2714-fe0f',
  'âŒ': '274c',
  'â': '274e',
  'â°': '27b0',
  'â¿': '27bf',
  'ã€½ï¸': '303d-fe0f',
  'âœ³ï¸': '2733-fe0f',
  'âœ´ï¸': '2734-fe0f',
  'â‡ï¸': '2747-fe0f',
  'Â©ï¸': '00a9-fe0f',
  'Â®ï¸': '00ae-fe0f',
  'â„¢ï¸': '2122-fe0f',
  'ğŸ”Ÿ': '1f51f',
  'ğŸ” ': '1f520',
  'ğŸ”¡': '1f521',
  'ğŸ”¢': '1f522',
  'ğŸ”£': '1f523',
  'ğŸ”¤': '1f524',
  'ğŸ…°ï¸': '1f170-fe0f',
  'ğŸ†': '1f18e',
  'ğŸ…±ï¸': '1f171-fe0f',
  'ğŸ†‘': '1f191',
  'ğŸ†’': '1f192',
  'ğŸ†“': '1f193',
  'â„¹ï¸': '2139-fe0f',
  'ğŸ†”': '1f194',
  'â“‚ï¸': '24c2-fe0f',
  'ğŸ†•': '1f195',
  'ğŸ†–': '1f196',
  'ğŸ…¾ï¸': '1f17e-fe0f',
  'ğŸ†—': '1f197',
  'ğŸ…¿ï¸': '1f17f-fe0f',
  'ğŸ†˜': '1f198',
  'ğŸ†™': '1f199',
  'ğŸ†š': '1f19a',
  'ğŸ”´': '1f534',
  'ğŸŸ ': '1f7e0',
  'ğŸŸ¡': '1f7e1',
  'ğŸŸ¢': '1f7e2',
  'ğŸ”µ': '1f535',
  'ğŸŸ£': '1f7e3',
  'ğŸŸ¤': '1f7e4',
  'âš«': '26ab',
  'âšª': '26aa',
  'ğŸŸ¥': '1f7e5',
  'ğŸŸ§': '1f7e7',
  'ğŸŸ¨': '1f7e8',
  'ğŸŸ©': '1f7e9',
  'ğŸŸ¦': '1f7ea',
  'ğŸŸª': '1f7eb',
  'ğŸŸ«': '1f7ec',
  'â¬›': '2b1b',
  'â¬œ': '2b1c',
  'â—¼ï¸': '25fc-fe0f',
  'â—»ï¸': '25fb-fe0f',
  'â—¾': '25fe',
  'â—½': '25fd',
  'â–ªï¸': '25aa-fe0f',
  'â–«ï¸': '25ab-fe0f',
  'ğŸ”¶': '1f536',
  'ğŸ”·': '1f537',
  'ğŸ”¸': '1f538',
  'ğŸ”¹': '1f539',
  'ğŸ”º': '1f53a',
  'ğŸ”»': '1f53b',
  'ğŸ’ ': '1f4a0',
  'ğŸ”˜': '1f518',
  'ğŸ”³': '1f533',
  'ğŸ”²': '1f532',
  'ğŸ': '1f3c1',
  'ğŸš©': '1f6a9',
  'ğŸŒ': '1f38c',
  'ğŸ´': '1f3f4',
  'ğŸ³ï¸': '1f3f3-fe0f',
  'ğŸ‘': '1f44d',
  'ğŸ‘': '1f44e',
  'ğŸ‘Œ': '1f44c',
  'âœŒï¸': '270c-fe0f',
  'ğŸ¤': '1f91e',
  'ğŸ¤Ÿ': '1f91f',
  'ğŸ¤˜': '1f918',
  'ğŸ¤™': '1f919',
  'ğŸ‘ˆ': '1f448',
  'ğŸ‘‰': '1f449',
  'ğŸ‘†': '1f446',
  'ğŸ‘‡': '1f447',
  'â˜ï¸': '261d-fe0f',
  'âœ‹': '270b',
  'ğŸ¤š': '1f91a',
  'ğŸ–ï¸': '1f590-fe0f',
  'ğŸ––': '1f596',
  'ğŸ‘‹': '1f44b',
  'ğŸ¤': '1f91d',
  'ğŸ™': '1f64f',
  'ğŸ’ª': '1f4aa',
  'ğŸ¦¾': '1f9be',
  'ğŸ¦¿': '1f9bf',
  'ğŸ¦µ': '1f9b5',
  'ğŸ¦¶': '1f9b6',
  'ğŸ‘‚': '1f442',
  'ğŸ¦»': '1f9bb',
  'ğŸ‘ƒ': '1f443',
  'ğŸ§ ': '1f9e0',
  'ğŸ«€': '1fac0',
  'ğŸ«': '1fac1',
  'ğŸ¦·': '1f9b7',
  'ğŸ¦´': '1f9b4',
  'ğŸ‘€': '1f440',
  'ğŸ‘ï¸': '1f441-fe0f',
  'ğŸ‘…': '1f445',
  'ğŸ‘„': '1f444'
}

const baseUrl = 'https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/72x72/'
const emojiDir = path.join(__dirname, '..', 'src', 'assets', 'emojis')

// åˆ›å»ºemojiç›®å½•
if (!fs.existsSync(emojiDir)) {
  fs.mkdirSync(emojiDir, { recursive: true })
}

console.log(`ğŸš€ å¼€å§‹ä¸‹è½½ ${Object.keys(emojiMap).length} ä¸ªemojiå›¾ç‰‡...`)

let downloadedCount = 0
let failedCount = 0
const totalCount = Object.keys(emojiMap).length

function downloadEmoji(emoji, unicode) {
  return new Promise((resolve, reject) => {
    const url = `${baseUrl}${unicode}.png`
    const filepath = path.join(emojiDir, `${unicode}.png`)
    
    // å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œè·³è¿‡
    if (fs.existsSync(filepath)) {
      console.log(`â­ï¸  ${emoji} (${unicode}) å·²å­˜åœ¨ï¼Œè·³è¿‡`)
      downloadedCount++
      resolve()
      return
    }
    
    const file = fs.createWriteStream(filepath)
    
    https.get(url, (response) => {
      if (response.statusCode !== 200) {
        console.log(`âŒ ${emoji} (${unicode}) ä¸‹è½½å¤±è´¥: HTTP ${response.statusCode}`)
        failedCount++
        file.close()
        fs.unlink(filepath, () => {}) // åˆ é™¤å¤±è´¥çš„æ–‡ä»¶
        resolve()
        return
      }
      
      response.pipe(file)
      
      file.on('finish', () => {
        file.close()
        console.log(`âœ… ${emoji} (${unicode}) ä¸‹è½½æˆåŠŸ`)
        downloadedCount++
        resolve()
      })
      
      file.on('error', (err) => {
        console.log(`âŒ ${emoji} (${unicode}) å†™å…¥å¤±è´¥:`, err.message)
        failedCount++
        file.close()
        fs.unlink(filepath, () => {}) // åˆ é™¤å¤±è´¥çš„æ–‡ä»¶
        resolve()
      })
    }).on('error', (err) => {
      console.log(`âŒ ${emoji} (${unicode}) ç½‘ç»œé”™è¯¯:`, err.message)
      failedCount++
      file.close()
      fs.unlink(filepath, () => {}) // åˆ é™¤å¤±è´¥çš„æ–‡ä»¶
      resolve()
    })
  })
}

async function downloadAllEmojis() {
  const promises = []
  
  for (const [emoji, unicode] of Object.entries(emojiMap)) {
    promises.push(downloadEmoji(emoji, unicode))
    
    // æ¯10ä¸ªå¹¶å‘ä¸‹è½½ï¼Œé¿å…è¿‡å¤šè¯·æ±‚
    if (promises.length >= 10) {
      await Promise.all(promises)
      promises.length = 0
      
      // æ˜¾ç¤ºè¿›åº¦
      const progress = Math.round((downloadedCount + failedCount) / totalCount * 100)
      console.log(`ğŸ“Š è¿›åº¦: ${downloadedCount + failedCount}/${totalCount} (${progress}%)`)
      
      // é—´éš”ä¸€ä¸‹ï¼Œé¿å…è¯·æ±‚è¿‡å¿«
      await new Promise(resolve => setTimeout(resolve, 500))
    }
  }
  
  // å¤„ç†å‰©ä½™çš„
  if (promises.length > 0) {
    await Promise.all(promises)
  }
  
  console.log(`\nğŸ‰ emojiå›¾ç‰‡ä¸‹è½½å®Œæˆï¼`)
  console.log(`âœ… æˆåŠŸ: ${downloadedCount} ä¸ª`)
  console.log(`âŒ å¤±è´¥: ${failedCount} ä¸ª`)
  console.log(`ğŸ“ ä¿å­˜è·¯å¾„: ${emojiDir}`)
}

downloadAllEmojis().catch(console.error) 